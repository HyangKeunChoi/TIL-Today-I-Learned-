## 분해 패턴

1. 비즈니스 능력에 따른 분해
  - 복잡한 비즈니스 능력을 기준으로 서비스를 분해
  - 송금 서비스, 주문서비스
    
2. 하위 도메인 패턴별 분해 (DDD)
  - 복잡한 비즈니스 일지라도, 포함된 내부의 하위 도메인을 단위로 분리
    - 계좌 도메인, 내부 머니 도메인, 뱅킹

   ![image](https://github.com/HyangKeunChoi/TIL-Today-I-Learned-/assets/49984996/c4c3675c-1318-405f-8bce-3a82ccff502f)
   
### 뱅킹 도메인
+ AML : 자금 세탁 방지
+ CTR, STR : 고액 의심 현금 거래


## 통신 패턴 (HTTP, GRPC)

![image](https://github.com/HyangKeunChoi/TIL-Today-I-Learned-/assets/49984996/ab641fa2-f7c3-4ac8-a1e8-72f7113f9f52)

> polling : 일정 주기마다 물어보는것

## 트랜잭션 패턴
+ 2PC
+ Saga Pattern : 2PC와 보상트랜잭션을 합친 개념
  - saga도 cordinator가 있음

## 데이터 쿼리 패턴
+ 데이터 쿼리의 어려움을 해결하기 위한 패텆ㄴ

+ API Aggregation 패턴 (API 조합 Pattern)
  - 필요한 데이터를 얻어오기 위해서, 분리된 서비스들 각각에 각 도메인에 대해 데이터를 요청 후 필요에 맞게 Aggregation
    - 송금이 최종적으로 성공한 요청건에 대해서, 같이 실행된 외부 은행에 대한 계좌 요청들의 외부 API 호출 횟수

+ CQRS 패턴
  - Command 작업과 Query 작업의 Endpoint를 분리하고 원하는 포맷대로 Query를 위한 데이터 구조를 만들어 이곳에서 복잡한 Query를 담당
 
## 가시성 패턴
+ msa 소프트웨어 아키텍처를 설계하면서 생긴 로깅, 모니터링의 어려움을 해결하기 위한 패턴\
+ 로깅 VS 메트릭 차이
  - 로깅은 트러블 슈팅을 위해 누락되어서는 안됨
  - 메트릭은 누락되어도 됨, 지표들을 시계열에 따라 저장(prometeous, InfluxDB)

## 신뢰성 패턴
+ 서킷 브레이커

## 테스트 패턴, 외부 API 패턴, 디스커버리 패턴

## 헥사고날 아키텍처
+ 각 계층에서 하던 일은 내부와 외부라는 개념으로 나누어 각각에 맞는 별도의 인터페이스를 정의
  - 어댑터와 포트
+ 내부 로직은 오직 외부를 통해서만 접근이 가능
  - 모든 외부 시스템과의 직접적인 상호작용은 어댑터의 역할
  - 각 서비스에서 비즈니스 로직에 맞게 정의된 인터페이스는 포트
  - 외부 서비스와의 상호 작용은 비즈니스 로직과의 작업을 정의한 인터페이스(포트)랑만 서로 통신
 
  + 모든 비즈니스 로직은, 오직 외부에서 내부 방향 / 내부에서 외부 방향으로만 호출이 가능
    - 인바운트 어댑터 -> 인바운드 포트 -> 비즈니스 로직
    - 비즈니스 로직 -> 아웃바운드 포트 -> 아웃바운드 어댑터
    
+ 어댑터 : 서비스의 입장에서 이 서비스가 사용하는 외부 시스템과의 직접적인 구현 및 상호작용을 처리
+ 포트 : 비즈니스 로직 입장에서 어댑터와 통신하기 위한 동작을 정의한 인터페이스

![image](https://github.com/HyangKeunChoi/TIL-Today-I-Learned-/assets/49984996/906f4b8a-e3a1-46b8-b6cf-b91d1280d25a)

![image](https://github.com/HyangKeunChoi/TIL-Today-I-Learned-/assets/49984996/57d56dd9-d8b5-4780-82d5-c9087939cc00)

